#!/usr/bin/env python3
import sqlite3
import logging

# Setup logging
logging.basicConfig(level=logging.INFO, format="%(asctime)s - %(levelname)s - %(message)s")
logger = logging.getLogger(__name__)

# Path to your SQLite database
DB_FILE = "DB/pepsources.db"

def clear_ai_ratings():
    try:
        conn = sqlite3.connect(DB_FILE)
        cursor = conn.cursor()
        # Update all rows in VendorDetails where ai_rating is not null or empty, setting it to NULL.
        cursor.execute("""
            UPDATE VendorDetails
            SET ai_rating = NULL
            WHERE ai_rating IS NOT NULL AND TRIM(ai_rating) <> ''
        """)
        conn.commit()
        rows_updated = cursor.rowcount
        logger.info(f"Cleared ai_rating for {rows_updated} rows in VendorDetails.")
    except Exception as e:
        logger.error(f"Error clearing ai_ratings: {e}")
    finally:
        conn.close()

if __name__ == "__main__":
    clear_ai_ratings()